# Untrusted data

Khái niệm:Dữ liệu nhập từ người dùng qua form, URL parameters, hoặc các trường nhập liệu khác mà hệ thống nhận được từ bên ngoài và không được xác thực hoặc kiểm soát chặt chẽ.

Lab: https://ninja-academy.cyberjutsu-lab.tech/

Mục tiêu: Tìm các điểm khai thác untrusted data

Công cụ khai thác: burp suite

Cách khai thác 20 điểm untrusted data để nhận 2 flag: nhập test vào những nơi nghi ngờ là untrusted data

1. Truy cập trang [https://ninja-academy.cyberjutsu-lab.tech/index.php](https://ninja-academy.cyberjutsu-lab.tech/index.php) 

![image.png](image.png)

![image.png](image%201.png)

![image.png](image%202.png)

![image.png](image%203.png)

1. Truy cập trang đăng ký [https://ninja-academy.cyberjutsu-lab.tech/sign-in.php](https://ninja-academy.cyberjutsu-lab.tech/sign-up.php) 

![image.png](image%204.png)

- Bắt burp xem tại sao lại thêm unstrusted data ở trường referer
- Trường referer  trong HTTP header dùng để **chỉ ra URL của trang trước đó**

![image.png](image%205.png)

1. Thấy có đường link chưa có tài khoản? nhấp vào qua trang [https://ninja-academy.cyberjutsu-lab.tech/sign-up.php](https://ninja-academy.cyberjutsu-lab.tech/sign-up.php)

- Nhâp test vào trường username và password

![image.png](image%206.png)

![image.png](image%207.png)

4. Quay lại trang [https://ninja-academy.cyberjutsu-lab.tech/sign-in.php](https://ninja-academy.cyberjutsu-lab.tech/sign-up.php) 

Nhập test vào username và password

![image.png](image%208.png)

![image.png](image%209.png)

1. Nhấn vào 1 đường link bất kỳ trong trang [https://ninja-academy.cyberjutsu-lab.tech/index.php](https://ninja-academy.cyberjutsu-lab.tech/index.php) rồi bắt request bằng burp

![image.png](image%2010.png)

Gửi request [https://ninja-academy.cyberjutsu-lab.tech/track.php?id=0](https://ninja-academy.cyberjutsu-lab.tech/index.php)  sang repeater

![image.png](image%2011.png)

thay id=test rồi send

![image.png](image%2012.png)

![image.png](image%2013.png)

1. Truy cập trang quản lý tài khoản [https://ninja-academy.cyberjutsu-lab.tech/profile.php](https://ninja-academy.cyberjutsu-lab.tech/profile.php)

nhập test vào trường nhẫn đạo, upload file test.txt có test trong file

![image.png](image%2014.png)

![image.png](image%2015.png)

1. Vào burp bắt request POST profile gửi qua repeater

![image.png](image%2016.png)

thay bio thành test rồi send

![image.png](image%2017.png)

![image.png](image%2018.png)

thay phương thức POST thành PUT rồi send

![image.png](image%2019.png)

![image.png](image%2020.png)

thay đuôi file từ profile.php thành test.php

![image.png](image%2021.png)

![image.png](image%2022.png)

thêm test ở trường cookie

![image.png](image%2023.png)

![image.png](image%2024.png)

thay dữ liệu ở trường user-agent thành test

![image.png](image%2025.png)

![image.png](image%2026.png)

truyền 1 tham số test

![image.png](image%2027.png)

![image.png](image%2028.png)

thêm 1 HTTP header test

![image.png](image%2029.png)

![image.png](image%2030.png)

thay content type của file upload

![image.png](image%2031.png)

![image.png](image%2032.png)

1. Xem hết các đường link trong trang web sẽ ra link ẩn

![image.png](image%2033.png)

![image.png](image%2034.png)

![image.png](image%2035.png)